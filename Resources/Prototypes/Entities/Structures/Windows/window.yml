  - type: entity
    parent: BaseStructure
    id: Window
    name: window
    description: Don't smudge up the glass down there.
    placement:
      mode: SnapgridCenter
      snap: [Window]
    components:
      - type: Sprite
        drawdepth: WallTops
        sprite: _Crescent/Structures/newWindow.rsi
      - type: Icon
        sprite: _Crescent/Structures/newWindow.rsi
        state: windowfull
      - type: StaticPrice
        price: 100
      - type: Appearance
      - type: Tag
        tags: [ForceFixRotations, Window, WeldbotFixableStructure]
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb {}
            mask: [FullTileMask]
            layer: [GlassLayer]
      - type: Destructible
        thresholds:
          - trigger: !type:DamageTrigger
              damage: 150 # excess damage (nuke?). avoid computational cost of spawning entities.
            behaviors:
              - !type:PlaySoundBehavior
                sound:
                  collection: WindowShatter
              - !type:DoActsBehavior
                acts: [Destruction]
          - trigger: !type:DamageTrigger
              damage: 50
            behaviors:
              - !type:PlaySoundBehavior
                sound:
                  collection: WindowShatter
              - !type:SpawnEntitiesBehavior
                spawn:
                  ShardGlass:
                    min: 1
                    max: 2
              - !type:DoActsBehavior
                acts: [Destruction]
      - type: Physics
        bodyType: Static
      - type: Damageable
        damageContainer: StructuralInorganic
        damageModifierSet: Glass
      - type: Construction
        graph: Window
        node: window
      - type: MeleeSound
        soundGroups:
          Brute:
            collection: GlassSmack
      - type: WallMount
        arc: 360 # interact despite grilles
      - type: ExaminableDamage
        messages: WindowMessages
      - type: Repairable
      - type: RCDDeconstructable
        cost: 6
        delay: 4
        fx: EffectRCDDeconstruct4
      - type: Airtight
      - type: IconSmooth
        key: walls
        base: window
      - type: DamageVisuals
        thresholds: [4, 8, 12]
        damageDivisor: 3.333
        trackAllDamage: true
        damageOverlay:
          sprite: Structures/Windows/cracks.rsi
      - type: BlockWeather
      - type: InteractionVerbs
        allowedVerbs: [KnockOn]
  - type: entity
    parent: Window
    id: WindowRCDResistant
    abstract: true
    components:
      - type: RCDDeconstructable
        deconstructable: false
  - type: entity
    parent: BaseStructure
    id: WindowDirectional
    name: directional window
    description: Don't smudge up the glass down there.
    placement:
      mode: SnapgridCenter
      snap: [Window]
    components:
      - type: Sprite
        drawdepth: Mobs
        sprite: Structures/Windows/directional.rsi
        state: window
      - type: Icon
        sprite: Structures/Windows/directional.rsi
        state: window
      - type: StaticPrice
        price: 10
      - type: Appearance
      - type: Tag
        tags:
          - Window
          - Directional # Delta V - Summary: Allows the tilewindow mapping command to work.
          - WeldbotFixableStructure
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.49,-0.49,0.49,-0.36
            density: 1500
            mask: [FullTileMask]
            layer: [GlassLayer]
      - type: Destructible
        thresholds:
          - trigger: !type:DamageTrigger
              damage: 150 # excess damage (nuke?). avoid computational cost of spawning entities.
            behaviors:
              - !type:DoActsBehavior
                acts: [Destruction]
              - !type:PlaySoundBehavior
                sound:
                  collection: WindowShatter
          - trigger: !type:DamageTrigger
              damage: 25
            behaviors:
              - !type:PlaySoundBehavior
                sound:
                  collection: WindowShatter
              - !type:SpawnEntitiesBehavior
                spawn:
                  ShardGlass:
                    min: 1
                    max: 1
              - !type:DoActsBehavior
                acts: [Destruction]
      - type: Physics
      - type: Damageable
        damageContainer: Inorganic
        damageModifierSet: Glass
      - type: Construction
        graph: WindowDirectional
        node: windowDirectional
      - type: WallMount
        arc: 360 # interact despite grilles
      - type: MeleeSound
        soundGroups:
          Brute:
            collection: GlassSmack
      - type: Repairable
      - type: ExaminableDamage
        messages: WindowMessages
      - type: RCDDeconstructable
        cost: 4
        delay: 2
        fx: EffectRCDDeconstruct2
      - type: Airtight
        noAirWhenFullyAirBlocked: false
        airBlockedDirection: [South]
      - type: DamageVisuals
        thresholds: [4, 8, 12]
        damageDivisor: 3.333
        trackAllDamage: true
        damageOverlay:
          sprite: Structures/Windows/cracks_directional.rsi
      - type: InteractionVerbs
        allowedVerbs: [KnockOn]
  - type: entity
    parent: WindowDirectional
    id: WindowDirectionalRCDResistant
    abstract: true
    components:
      - type: RCDDeconstructable
        deconstructable: false
  - type: entity
    parent: WindowDirectional
    id: WindowFrostedDirectional
    name: directional frosted window
    description: Don't smudge up the glass down there.
    placement:
      mode: SnapgridCenter
      snap: [Window]
    components:
      - type: Sprite
        sprite: Structures/Windows/directional.rsi
        state: frosted_window
      - type: Icon
        sprite: Structures/Windows/directional.rsi
        state: frosted_window
