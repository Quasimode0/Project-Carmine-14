  - type: entity
    id: DisposalPipeBase
    abstract: true
    placement:
      mode: SnapgridCenter
      snap: [Disposal]
    components:
      - type: Sprite
        visible: false
      - type: StaticPrice
        price: 22
      - type: Appearance
      - type: Tag
        tags: [Disposal]
      - type: Clickable
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.25,-0.5,0.25,0.5
            mask: [SubfloorMask]
      - type: Destructible
        thresholds:
          - trigger: !type:DamageTrigger
              damage: 100 # excess damage (nuke?). avoid computational cost of spawning entities.
            behaviors:
              - !type:DoActsBehavior
                acts: [Destruction]
          - trigger: !type:DamageTrigger
              damage: 50
            behaviors:
              - !type:PlaySoundBehavior
                sound:
                  collection: MetalBreak
              - !type:DoActsBehavior
                acts: [Breakage]
              - !type:ChangeConstructionNodeBehavior
                node: broken
      - type: Physics
        bodyType: Static
        canCollide: false
      - type: Damageable
        damageContainer: Inorganic
        damageModifierSet: Metallic
      - type: Transform
        anchored: true
      - type: ContainerContainer
        containers:
          DisposalTube: !type:Container
      - type: Visibility
        layer: 1
      - type: SubFloorHide
      - type: InteractionOutline
      - type: Anchorable
      - type: Rotatable
      - type: Pullable
      - type: CollideOnAnchor
  - type: entity
    id: DisposalHolder
    name: disposal holder
    categories: [HideSpawnMenu]
    components:
      - type: ContainerContainer
        containers:
          DisposalHolderComponent: !type:Container
      - type: DisposalHolder
  - type: entity
    parent: DisposalPipeBase
    id: DisposalPipeBroken
    name: broken disposal pipe
    description: A BBP (big broken pipe)
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: pipe-b
      - type: Construction
        graph: DisposalPipe
        node: broken
  - type: entity
    parent: DisposalPipeBase
    id: DisposalPipe
    name: disposal pipe segment
    description: A huge pipe segment used for constructing disposal systems.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-s
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-s}
              Anchored: {state: pipe-s}
      - type: Construction
        graph: DisposalPipe
        node: pipe
      - type: ContainerContainer
        containers:
          DisposalTransit: !type:Container
      - type: DisposalTube
        containerId: DisposalTransit
      - type: DisposalTransit
  - type: entity
    parent: DisposalPipeBase
    id: DisposalTagger
    name: disposal pipe tagger
    description: A pipe that tags entities for routing.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-tagger
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-tagger}
              Anchored: {state: pipe-tagger}
      - type: UserInterface
        interfaces:
          enum.DisposalTaggerUiKey.Key:
            type: DisposalTaggerBoundUserInterface
      - type: Construction
        graph: DisposalPipe
        node: tagger
      - type: ContainerContainer
        containers:
          DisposalTagger: !type:Container
      - type: DisposalTube
        containerId: DisposalTagger
      - type: DisposalTagger
      - type: ActivatableUI
        key: enum.DisposalTaggerUiKey.Key
  - type: entity
    parent: DisposalPipeBase
    id: DisposalTrunk
    name: disposal trunk
    description: A pipe trunk used as an entry point for disposal systems.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-t
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-t}
              Anchored: {state: pipe-t}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.25,-0.5,0.25,0.4
            mask: [SubfloorMask]
      - type: Construction
        graph: DisposalPipe
        node: trunk
      - type: ContainerContainer
        containers:
          DisposalEntry: !type:Container
      - type: DisposalTube
        containerId: DisposalEntry
      - type: DisposalEntry
  - type: entity
    parent: DisposalPipeBase
    id: DisposalRouter
    name: disposal router
    description: A three-way router. Entities with matching tags get routed to the side via configurable filters.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-j1s
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-j1s}
              Anchored: {state: pipe-j1s}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.5,-0.5,0.25,0.5
            mask: [SubfloorMask]
      - type: UserInterface
        interfaces:
          enum.DisposalRouterUiKey.Key:
            type: DisposalRouterBoundUserInterface
      - type: Construction
        graph: DisposalPipe
        node: router
      - type: ContainerContainer
        containers:
          DisposalRouter: !type:Container
      - type: DisposalTube
        containerId: DisposalRouter
      - type: DisposalRouter
        degrees: [0, -90, 180]
      - type: Flippable
        mirrorEntity: DisposalRouterFlipped
      - type: ActivatableUI
        key: enum.DisposalRouterUiKey.Key
  - type: entity
    parent: DisposalRouter
    id: DisposalRouterFlipped
    description: A three-way router. Entities with matching tags get routed to the side.
    suffix: flipped
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-j2s
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-j2s}
              Anchored: {state: pipe-j2s}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.25,-0.5,0.5,0.5
            mask: [SubfloorMask]
      - type: Construction
        node: routerflipped
      - type: ContainerContainer
        containers:
          DisposalRouter: !type:Container
      - type: DisposalTube
        containerId: DisposalRouter
      - type: DisposalRouter
        degrees: [0, 90, 180]
      - type: Flippable
        mirrorEntity: DisposalRouter
  - type: entity
    parent: DisposalPipeBase
    id: DisposalJunction
    name: disposal junction
    description: A three-way junction. The arrow indicates where items exit.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-j1
        visible: true
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-j1}
              Anchored: {state: pipe-j1}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.5,-0.5,0.25,0.5
            mask: [SubfloorMask]
      - type: Construction
        graph: DisposalPipe
        node: junction
      - type: ContainerContainer
        containers:
          DisposalJunction: !type:Container
      - type: DisposalTube
        containerId: DisposalJunction
      - type: DisposalJunction
        degrees: [0, -90, 180]
      - type: Flippable
        mirrorEntity: DisposalJunctionFlipped
  - type: entity
    parent: DisposalJunction
    id: DisposalJunctionFlipped
    description: A three-way junction. The arrow indicates where items exit.
    suffix: flipped
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-j2
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-j2}
              Anchored: {state: pipe-j2}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.25,-0.5,0.5,0.5
            mask: [SubfloorMask]
      - type: Construction
        node: junctionflipped
      - type: ContainerContainer
        containers:
          DisposalJunction: !type:Container
      - type: DisposalTube
        containerId: DisposalJunction
      - type: DisposalJunction
        degrees: [0, 90, 180]
      - type: Flippable
        mirrorEntity: DisposalJunction
  - type: entity
    parent: DisposalPipeBase
    id: DisposalYJunction
    name: disposal y-junction
    description: A three-way junction with another exit point.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-y
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-y}
              Anchored: {state: pipe-y}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.5,-0.5,0.5,0.25
            mask: [SubfloorMask]
      - type: Construction
        graph: DisposalPipe
        node: yJunction
      - type: ContainerContainer
        containers:
          DisposalJunction: !type:Container
      - type: DisposalTube
        containerId: DisposalJunction
      - type: DisposalJunction
        degrees: [0, 90, -90]
  - type: entity
    parent: DisposalPipeBase
    id: DisposalBend
    name: disposal bend
    description: A tube bent at a 90 degree angle.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        sprite: Structures/Piping/disposal.rsi
        layers:
          - map: [pipe]
            state: conpipe-c
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: conpipe-c}
              Anchored: {state: pipe-c}
      - type: Fixtures
        fixtures:
          fix1:
            shape: !type:PhysShapeAabb
              bounds: -0.5,-0.5,0.25,0.25
            mask: [SubfloorMask]
      - type: Construction
        graph: DisposalPipe
        node: bend
      - type: ContainerContainer
        containers:
          DisposalBend: !type:Container
      - type: DisposalTube
        containerId: DisposalBend
      - type: DisposalBend
  - type: entity
    parent: DisposalJunction
    id: DisposalSignalRouter
    name: disposal signal router
    description: A signal-controlled three-way router.
    components:
      - type: Sprite
        drawdepth: ThickPipe
        layers:
          - map: [pipe]
            state: signal-router-free
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: signal-router-free}
              Anchored: {state: signal-router}
      - type: Construction
        graph: DisposalPipe
        node: signal_router
      - type: ContainerContainer
        containers:
          DisposalSignalRouter: !type:Container
      - type: DisposalTube
        containerId: DisposalSignalRouter
      - type: DisposalSignalRouter
      - type: DeviceLinkSink
        ports: [true, false, Toggle]
      - type: DeviceNetwork
        deviceNetId: Wireless
        receiveFrequencyId: BasicDevice
      - type: WirelessNetworkConnection
        range: 200
      - type: Flippable
        mirrorEntity: DisposalSignalRouterFlipped
  - type: entity
    parent: DisposalSignalRouter
    id: DisposalSignalRouterFlipped
    suffix: flipped
    components:
      - type: Sprite
        layers:
          - map: [pipe]
            state: signal-router-flipped-free
      - type: GenericVisualizer
        visuals:
          enum.DisposalTubeVisuals.VisualState:
            pipe:
              Free: {state: signal-router-flipped-free}
              Anchored: {state: signal-router-flipped}
      - type: Construction
        node: signal_router_flipped
      - type: DisposalJunction
        degrees: [0, 90, 180]
